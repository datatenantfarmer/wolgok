DATA ECOiN; 
INPUT spr call eir build foreign bok exc bokfrac economy;
cards;
0.31   3.26   3.2   7877.7   1555.5   4641.8   1038.13   0.034388798   69.4
0.65   3.26   3.3   7786.7   1652.6   4641.9   1020.51   0.034389539   69.5
0.96   3.25   3   8317.1   1591   4641.8   1008.01   0.034388798   69.8
1.04   3.26   2.9   8274.9   1641.3   4641.8   1009.73   0.034388798   69.9
0.84   3.29   3.3   9453   1726.5   4641.8   1002.42   0.034388798   70.2
0.72   3.27   3.5   8836.8   1926.6   5634   1012.18   0.041739517   70.5
0.82   3.25   3.3   9253.2   2091   5633.9   1037.5   0.041738776   70.8
1.09   3.25   3.2   8599.4   2271.7   5634   1021.53   0.041739517   71.1
1.38   3.25   2.9   7769.4   2349.6   5523   1029.5   0.040917173   71.4
1.54   3.44   3.1   6786.9   2418.5   5523   1046.2   0.040917173   71.7
1.69   3.49   3.1   6337.1   2525.3   5443.9   1040.57   0.04033116   72.3
1.71   3.7   3.1   6518.9   2575   5253.9   1023.12   0.038923544   72.7
1.69   3.74   3   7387.8   2773.5   4859.4   983.76   0.047929694   73.1
1.43   3.92   3   7668.6   2742.3   5835.8   969.96   0.057560215   73.2
1.27   3.97   3   7683   2851.9   6086.2   975.34   0.060029984   73.6
1.15   3.97   2.8   6989.8   2665.7   6086.2   952.92   0.060029984   73.8
1.11   3.96   2.8   7236.8   2913.7   6086.2   941.21   0.060029984   74.1
1.01   4.17   2.8   7607.6   3440.8   6086.2   955.17619   0.060029984   74.2
0.87   4.21   3   8702.2   3745.2   6587.9   950.56   0.064978399   74
0.69   4.42   3   8961.3   3861.7   7542.1   961.02   0.074389955   74.2
0.5   4.47   3   9972.6   3907.5   7542.1   952.77   0.074389955   74.6
0.3   4.48   3   9056.5   3869.8   7154.3   954.17   0.07056497   75.6
0.27   4.47   2.9   9171.2   4077.8   7896.3   935.52   0.077883534   76.1
0.3   4.49   3.1   8751.7   4187.1   7896.3   925.08   0.077883534   76.4
0.36   4.63   3   9637.8   5057.2   8198.8   936.9   0.775813777   76.5
0.36   4.6   2.9   10269.3   5688.8   8198.8   937.17   0.712877141   76.8
0.31   4.6   3   10222.1   5865.8   8086.9   943.23   1.179708242   77.1
0.28   4.69   2.9   10297.1   6482.2   8586.3   930.95   1.745892639   77.5
0.34   4.61   2.9   9527.8   7572.9   8586.3   927.39   1.58331182   77.8
0.53   4.54   2.8   9849.7   7640.5   8324.7   927.50714   1.03041218   78
0.7   4.67   2.9   9298.3   8618.7   8657.2   918.45   0.789026613   78.3
0.66   4.92   2.8   9743.8   12506.6   8657.2   934.92   0.764162768   78.6
0.54   4.98   2.8   10242.9   17001.9   8169.2   930.89   1.711185589   78.8
0.45   5   2.9   11339.6   18706.8   8652.1   914.81   2.316492637   79.2
0.51   5   3   12330.6   22998.1   9484   918.11   1.578299218   79.6
0.66   4.99   3   11725.4   25358.2   10635.6   930.76   3.65735901   80
0.67   4.99   3.2   10403.4   27302.5   10635.5   942.72   1.147303128   80.4
0.53   4.97   3.3   9302.8   28835.8   10635.6   944.42   1.346619397   80.6
0.31   4.97   3.5   9227.2   27917.4   9808.8   982.51   2.072865596   80.8
0.14   4.99   3.4   10006.8   29287.9   9808.8   987.24   2.057214765   80.8
0.22   4.97   3.8   9942.1   29899.2   9808.8   1038.21   1.413779187   80.8
0.42   4.95   4.1   9121   28891.9   10289.6   1031.07   0.994068206   80.6
0.76   4.98   4.4   8095.9   26770.5   10289.5   1018.18   1.316634677   80.6
0.83   5.21   4.2   7907.9   26818.1   10766   1047.11   1.592132505   80.7
0.76   5.21   4.5   7393.1   21511.9   10068.8   1136.64   2.810159085   80.9
0.51   4.88   4.6   7718.3   20441.3   10068.8   1326.85   4.152082474   80.9
0.7   4   4.5   7330   20117.5   11053.4   1400.81   2.220896122   80.5
0.83   3.27   4.3   9268.6   20084.8   11248.2   1368.8   2.18242142   79.7
1.25   2.43   4.2   9287.4   19789   11248.1   1354.68   1.498947228   79.3
1.7   2.06   4.3   9125.3   19755.7   11248.1   1440.19   1.1694843   79.4
2.27   1.77   4.5   7821.5   19826.1   11248.1   1453.35   1.487057113   79.7
2.63   1.8   4.3   8052   19260.1   11248.2   1336.28   1.701179673   80.1
2.66   1.91   4.2   8525.5   19786.6   11248.1   1255.62   2.266391296   80.3
2.68   1.93   4.3   9011.9   20191.6   11361.8   1262.28   1.578246979   81
2.7   1.93   4.1   8449.7   21432.5   11361.8   1261.96   1.380702394   81.3
2.8   1.98   3.8   7835.8   22445.9   11361.8   1239.69   1.195727215   81.7
2.82   1.99   3.7   7575.8   24583.4   11969.5   1215   2.276435907   82
2.9   1.99   3.5   9088.3   27829.2   12670.9   1174.8   2.895543876   82.5
2.87   2   3.3   11442.8   28680.4   12670.9   1163.18   1.435633356   82.8
2.84   2   3.2   11832.1   27538.5   12670.1   1166.13   2.106067154   82.9
2.81   2   3.1   11238.5   29465.2   12670   1138.77   3.687427241   83.3
2.79   2   3.1   8986.3   31034.6   12670.1   1156.83   3.488463656   83.8
2.69   2.01   3   7890.2   33336.1   13291.6   1136.11   2.823794349   84.4
2.55   2   3   7060.4   36188.7   13291.6   1115.71   1.654624673   85
2.43   2.01   3   7984.3   40342.9   13905.7   1168.41   2.038062436   85.6
2.42   2   2.9   8294   39310.2   13340.4   1212.49545   2.520861678   85.9
2.35   2.21   3   8755.4   41624.6   13340.5   1204.94   3.010040614   86.3
2.22   2.27   3.1   7315.7   44048.3   14075.5   1179.9864   2.10490504   86.3
1.96   2.27   3.1   7459.4   45767.8   14075.4   1162.94   1.541833717   86.3
1.68   2.26   3.3   5925.5   47631.4   14830.7   1122.23   1.561126316   86.2
1.57   2.37   3.2   6324   48705.4   14830.7   1128.08   1.381399031   86.4
1.53   2.5   3.2   6152.6   47745   13639.5   1146.23   0.719420856   86.8
1.61   2.66   3.6   6820.1   48415.4   14258.2   1119.43   0.792562535   87.7
1.61   2.75   3.7   6510.5   49523.9   14876.8   1119.51   1.114617517   87.8
1.5   2.92   3.9   6384.9   50635.7   14212.2   1120.4455   0.898369153   88.2
1.32   3.01   4   6602.3   51768   14169.2   1084.83   0.909681561   88.2
1.08   3.02   3.9   7053.5   53805.3   14169.3   1084.05   0.732717965   88.7
0.92   3.2   4   7387.3   56802.7   14484.9   1080.87   0.598203519   89.1
0.79   3.26   4   7042.6   58855.8   15522.7   1058.49   0.545670897   89.4
0.64   3.25   4.3   7625.6   59742.3   15522.8   1074.05   0.499366254   89.8
0.5   3.25   4.3   7347.2   59930.3   14415.2   1125.09   0.577972014   89.7
0.38   3.24   4.3   7742.5   62578.3   14404.5   1150.25   0.652023357   90
0.31   3.26   4.2   7313.1   63063.6   14404.5   1134.19   0.446845142   89.9
0.29   3.26   4.1   7619.7   60992.3   14404.5   1148.3   0.543873891   90
0.25   3.26   4.2   8363.1   61555   14934.7   1144.56   0.447093162   90
0.26   3.25   4.1   9090.4   62366.5   15486.4   1122.9381   0.284838787   90.5
0.33   3.25   4.1   8465.3   62539.8   14520.4   1126.94   0.23438524   90.8
0.38   3.25   3.9   7720.9   63139.3   14950   1135.41   0.345449084   90.9
0.35   3.26   3.8   6856.4   63265   14950.1   1157.07   0.241563121   91.1
0.26   3.26   3.8   7608.4   58518   14950   1163.61   0.197279001   91.3
0.14   3.08   3.7   7850.2   60353.6   14943.5   1142.33182   0.162969628   91.7
0.04   3   3.6   7538.8   60028.3   15484.9   1132.06   0.15559117   91.5
-0.04   2.99   3.5   6551.7   61288.5   14501.2   1123.67   0.176841746   91.6
-0.04   2.8   3.3   5805.2   62134.4   15037.9   1105.49   0.2514699   91.6
0.02   2.75   3.2   5805.4   59173.5   15597.7   1087.15   0.283378148   91.9
0.13   2.75   3.1   5758.5   57228.3   15597.7   1076.42   0.305855246   92.2
0.15   2.76   3.2   5363.8   57424.1   15529.5   1066.54   0.220743131   92.4
0.14   2.75   3.2   5256.1   59726.2   15529.5   1086.06   0.282339145   92.6
0.04   2.74   3.2   5283.2   60281   14408.4   1103.81   0.278967647   92.7
-0.03   2.75   3.1   5594.4   62943   15127.7   1121.1   0.292922702   93
-0.01   2.55   2.9   5624.4   63898.9   15127.7   1112.1   0.277379075   93.2
0.2   2.49   2.8   5621.6   61701.8   15127.7   1136.59   0.293075925   93.7
0.47   2.48   2.9   5965.5   61702.4   15127.8   1126.595   0.26779133   93.9
0.68   2.5   3   5762.3   61491.1   15863.3   1116.16   0.253188942   94.1
0.71   2.5   2.9   6073.5   60122.9   14576.9   1084.79   0.32114783   94.2
0.67   2.5   2.9   6309.5   60089.8   14576.8   1065.74   0.2586098   94.7
0.66   2.5   2.9   6889   60122.8   15310.6   1062.69   0.211265196   94.9
0.71   2.5   2.9   7124   58691.4   15260.5   1056.06   0.238300098   95.3
0.77   2.5   2.9   7194.4   58701.3   15260.4   1065.8   0.286107466   95.8
0.74   2.49   2.9   7094.9   59053.7   15973.4   1070.97   0.310524883   96.1
0.71   2.48   2.8   6357.7   59542.6   14640.1   1070.69   0.316453754   96.5
0.68   2.49   2.9   6496.2   61492.2   15342.7   1042.75   0.285519949   96.6
0.65   2.49   2.8   6499.2   61771.5   15342.6   1023.99   0.288086073   96.6
0.59   2.48   2.8   7335.5   62853.8   15316.6   1018.7   0.209710147   96.8
0.45   2.49   2.8   7343.4   63376   15342.7   1020.6   0.200954826   97.1
0.4   2.34   2.8   8466.9   63705.9   16059.2   1024.61   0.243601723   97.5
0.38   2.23   2.8   8688.6   63125.6   15439.2   1035.8   0.253688033   97.5
0.4   2.06   2.7   8565.2   64679.5   16196.6   1060.91   0.233289642   97.5
0.38   1.98   2.7   7190.4   65368.6   16196.6   1097.11   0.228236852   97.6
0.35   1.99   2.6   6761   65888.8   16867.3   1103.6   0.241613786   98.1
0.29   1.99   2.6   7552.4   65926.3   16867.3   1088.48   0.211017978   98.4
0.22   1.99   2.6   7886.8   67311   16867.3   1098.38   0.256509573   99
0.15   1.82   2.5   9859.3   68888   16350.5   1113.05   0.195199551   99.1
0.14   1.73   2.5   9809.3   69665.6   16350.5   1085.9   0.202859801   99.4
0.22   1.74   2.4   11949.4   70276.2   16350.5   1093.03   0.305937056   99.2
0.32   1.57   2.5   11226.5   69499.8   16307.7   1112.44   0.265429125   99.3
0.47   1.48   2.6   11340.3   68200.9   17102   1146.16   0.265620874   99.6
0.5   1.49   2.5   10485.8   68288.4   17102   1180.04   0.272246808   100.1
0.47   1.48   2.5   13378.1   67256.1   15500.1   1185.06   0.24310069   100.9
0.38   1.48   2.5   13411.5   68005   16268.3   1144.8   0.211309555   101.6
0.38   1.49   2.5   14169.6   68079.6   16268.3   1153.35   0.217078541   101.6
0.39   1.48   2.5   10427   67890.5   16177.8   1173.2   0.28425991   101.9
0.39   1.49   2.5   10519.5   68197.9   16177.8   1203.79   0.253300557   101.8
0.27   1.49   2.5   10312.3   67623.5   16177.8   1220.45   0.291491892   101.9
0.17   1.49   2.5   11700.3   68661.4   15396.7   1182.15   0.234052871   102
0.1   1.49   2.5   12318.6   70365.8   15396.7   1146.71   0.275383652   102.3
0.09   1.49   2.4   11657   70693.4   15396.7   1174.58   0.271183246   102.7
0.09   1.28   2.4   10890.2   70817.6   15396.7   1168.36   0.216531657   103.2
0.07   1.23   2.4   11726.8   72489.5   15396.7   1141.7   0.241831718   103.7
0.06   1.23   2.4   13261.3   73256.2   15396.7   1111.67727   0.313597572   104
0.05   1.24   2.5   13802   73880.6   13319.9   1106.77   0.414047249   104
0.11   1.23   2.5   13622   73345.3   13319.9   1125.77895   0.717899105   104.1
0.27   1.23   2.5   12603.8   72073.4   14597   1159.935   0.758798149   104.5
0.45   1.22   2.5   12480.6   72842.6   14499.4   1183.3   1.055269287   105
0.58   1.24   2.8   11785.4   73947.5   14499.4   1182.24   0.834017831   105.6
0.62   1.23   2.7   12438.8   77025.9   15248.8   1143.36   0.782511418   105.8
0.63   1.23   2.6   11522   76749.9   14787.9   1133.94546   0.608505473   106.3
0.65   1.23   2.6   12703.9   78042.7   15540.6   1133.57   0.676737502   106.6
0.66   1.23   2.5   12011.1   78859.4   15540.6   1124.65   0.755792238   106.9
0.64   1.24   2.6   12548.1   79037.7   16289.3   1131.62   0.540024533   107
0.67   1.24   2.5   10716.9   81321.4   16289.3   1133.13   0.631245883   107.2
0.69   1.23   2.6   11315.3   81074.6   16289.4   1131.4   0.646404762   107.4
0.73   1.25   2.6   11199   81111.3   14218.3   1132.93   0.705342792   107.7
0.84   1.24   2.6   11090.1   79436.1   14218.3   1129.48   0.740382212   107.7
0.95   1.26   2.5   9990.1   78822.4   14937.2   1102.82   0.626245179   108
0.97   1.51   2.5   10993.8   78264.9   14831.6   1085.95   0.764712555   107.9
0.95   1.49   2.6   12802.2   79262.4   14831.6   1066.54   0.520224483   108.2
0.93   1.49   2.6   12545.8   81662.5   15523.1   1080.7   0.670573243   108.5
1   1.49   2.6   11788.3   82097.1   15650.9   1071.21   0.636163727   108.8
1.01   1.47   2.6   9919.7   83775.7   16327.5   1068.05   0.723993437   108.9
1   1.5   2.6   10978   85108.1   17005   1077.05   0.656969556   109.1
0.98   1.49   2.6   10428.1   88323.6   17004.9   1095.96   0.765538198   109.2
0.94   1.49   2.6   11330.7   89865.6   17693.5   1123.05   0.614635078   109.2
0.85   1.5   2.7   10250.4   91133   17693.5   1120.96   0.53504793   109.2
;

RUN;
Data timeecon;
set ecoin;
time=_n_;
newspr=10*spr;
dy=dif(newspr);
run;



data int;
set timeecon;
if time = 28 then pt1=1; else pt1=0;
if time < 28 then  st1=0; else st1=1;
if time =45 then pt1_1=1; else pt1_1=0;
if time <45 then st1_1=0; else st1_1=1;
if time = 67 then pt2=1; else pt2=0;
if time <67 then st2=0; else st2=1;
run;

PROC ARIMA DATA=INT;
IDENTIFY VAR=call(1);
estimate p=(1 2 3) q=(1 2 3);
estimate p=(1 2 3) q=(1 3) noconstant;
estimate p=(2 3) q=(1 3) noconstant;
RUN;

PROC ARIMA DATA=INT;
IDENTIFY VAR=foreign(1);
estimate p=(1 2 6 8) q=(1 2 3) maxiter=300;
estimate p=(2 6 8) q=(1 2 3) maxiter=300;
estimate p=(2 6 8) q=(1 3) maxiter=300;
estimate p=(2 6 8 20) q=(1 3) maxiter=300;
RUN;

%origin_p(int, 2005, 1, 1, foreign);

PROC ARIMA DATA=INT;
IDENTIFY VAR=ECONOMY;
IDENTIFY VAR=ECONOMY(1);
estimate p=(1 2 3) q=(1 2 3);
estimate p=(1 2 3)(12) q=(1 2 3)(12);
estimate p=(2 3)(12) q=(1 2 3)(12);
estimate p=(2 3) q=(1 2 3)(12);
estimate p=(2 3) q=(1 2)(12);
estimate p=(3) q=(1 2)(12);
RUN;


/* 유럽발 lag 4 미국발 lag 9 */
proc arima data=int out=pp;
identify var=newspr(1) crosscorr=(st1 pt1 pt2 st2 call(1) foreign(1) economy(1) );
run;

%origin_p(int, 2005, 1, 1, newspr);

proc arima data=int out=pp;
identify var=newspr(1) crosscorr=(st1(1) pt2(1));
estimate input=(9$/(1)st1 4$/(1)pt2);
forecast;
run;

proc arima data=int out=pp;
identify var=newspr(1) crosscorr=(st1(1) pt2(1));
estimate input=(9$/(1)st1 4$/(1)pt2);
run;

%origin_p(pp,2005,1,1,residual);

proc arima data=int;
identify var=call(1);
estimate p=(2 3) q=(1 3) noconstant;
identify var=foreign(1);
estimate p=(2 6 8 20) q=(1 3) maxiter=300;
identify var=ECONOMY(1);
estimate p=(3) q=(1 2)(12);
identify var=newspr(1) crosscorr=(st1(1) pt2(1) call(1) foreign(1) economy(1)) nlag=36;
estimate input=(9$/(1)st1 4$/(1)pt2);
estimate p=(1 2)(6 12) q=(1 2)(6) input=(9$/(1)st1 4$/(1)pt2) maxiter=400;
estimate p=(1 2)(6 12) q=(1 2) input=(9$/(1)st1 4$/(1)pt2) maxiter=400;
estimate p=(1 2)(6) q=(1 2) input=(9$/(1)st1 4$/(1)pt2) maxiter=400 noconstant;
estimate p=(1)(6) q=(1 2) input=(9$/(1)st1 4$/(1)pt2) maxiter=400 noconstant;
estimate p=(1 10)(6) q=(1 2) input=(9$/(1)st1 4$/(1)pt2) maxiter=400 noconstant;
estimate p=(1 10)(6) q=(1 2) input=(9$/(1)st1 4$/(1)pt2) maxiter=400 noconstant;
forecast back=4;
run;

%origin_p(int, 2005, 1, 1, spr);

data int;
set int;
ts=1/sqrt(3.5-spr);
dts=dif(ts);
run;

%origin_p(int, 2005, 1, 1, ts);
%origin_p(int, 2005, 1, 1, dts);

proc print data=int;
var ts spr;
run;

proc arima data=int;
identify var=call(1);
estimate p=(2 3) q=(1 3) noconstant;
identify var=foreign(1);
estimate p=(2 6 8 20) q=(1 3) maxiter=300;
identify var=ECONOMY(1);
estimate p=(3) q=(1 2)(12);
identify var=ts(1) crosscorr=(call(1) foreign(1) economy(1)) nlag=24;
run;

%origin_p(int, 2005, 1, 1, eir);
proc arima data=int out=pp;
identify var=eir(1) crosscorr=(st1(1) pt2(1));
estimate input=(5$/(1)st1 2$pt2) maxiter=500;
forecast;
run;

data pp;
set pp;
dr=dif(residual);
run;

%origin_p(pp, 2005,1,1,eir);
%origin_p(pp, 2005, 1, 1, residual);
%origin_p(pp, 2005, 1, 1, dr);

proc arima data=int;
identify var=eir(1) crosscorr=(st1(1) pt2(1)) nlag=48;
estimate input=(5$/(1)st1 2$pt2) maxiter=500;
estimate p=(4 5 15) q=(4 5 20) input=(5$/(1)st1 2$pt2) maxiter=2000;
estimate p=(4 5 15) q=(4 20) input=(5$/(1)st1 2$pt2) maxiter=2000;
estimate p=(5 15) q=(4 20) input=(5$/(1)st1 2$pt2) maxiter=2000;
estimate p=(13 15) q=(4 20) input=(5$/(1)st1 2$pt2) maxiter=2000;
estimate p=(13 15 21) q=(4 20) input=(5$/(1)st1 3$pt2) maxiter=2000;
run;

data int;
set int;
teir=-1/sqrt(eir);
dt=dif(teir);
run;

%origin_p(int, 2005, 1, 1, eir);
%origin_p(int, 2005, 1, 1, teir);
%origin_p(int, 2005, 1, 1, dt);

data ko;
infile '/home/albam10240/KOSPI.txt';
input x;
lx=log(x);
time=_n_;
dlx=dif(lx);
run;

%origin_p(ko, 2005, 1, 1, x);



data pp;
set pp;
dr=dif(residual);
run;

%origin_p(ko, 2005, 1, 1, lx);

proc arima data=ko;
identify var=lx(1);
estimate p=(1 2)(3) q=(1 2)(3);
estimate p=(1 2) q=(1 2)(3) noconstant;
run;

data int;
merge int ko;
run;

proc arima data=int;
identify var=foreign(1) nlag=24;
estimate p=(2 6 8 20) q=(1 3) maxiter=300 ml;
estimate p=(2 6 8 20) q=(1 19 21) maxiter=300 ml;
run;

data cds;
infile '/home/albam10240/cds.txt';
input x;
time=_n_;
llx=log(x);
dx=dif(x);
dllx=dif(llx);
run;

proc arima data=cds;
identify var=llx;
identify var=llx(1);
run;

data cds;
set cds;
if time = 28 then pt1=1; else pt1=0;
if time < 28 then  st1=0; else st1=1;
if time =43 then pt1_1=1; else pt1_1=0;
if time <43 then st1_1=0; else st1_1=1;
if time = 67 then pt2=1; else pt2=0;
if time <67 then st2=0; else st2=1;
run;

%origin_p(cds, 2005, 1, 1, x);

proc arima data=cds out=p1;
identify var=llx crosscorr=(st1_1 pt1_1);
estimate input=(4$/(1)st1_1) maxiter=4000;
forecast;
run;

data p1;
set p1;
dr=dif(residual);
run;

%origin_p(cds, 2005, 1, 1, dllx)
%origin_p(p1, 2005, 1, 1, residual);
%origin_p(p1, 2005, 1, 1, dr);

proc arima data=cds;
identify var=llx(1) crosscorr=(st1_1(1)) nlag=36;
estimate input=(4$/(1)st1_1) ml;
run;


data int;
merge int cds;
run;

/* lx = kospi, llx = cds */
proc arima data=int;
identify var=call(1);
estimate p=(2 3) q=(1 3) noconstant;
identify var=foreign(1);
estimate p=(2 6 8 20) q=(1 19 21) maxiter=300 ml;
identify var=ECONOMY(1);
estimate p=(3) q=(1 2)(12);
identify var=lx(1);
estimate p=(1 2) q=(1 2)(3) noconstant;
identify var=x(1);
estimate p=(1 4 7) q=(6) maxiter=200 noconstant;
identify var=llx(1) crosscorr=(st1_1(1)) nlag=36;
estimate input=(4$/(1)st1_1);
identify var=ts(1) crosscorr=(call(1) foreign(1) economy(1) lx(1) llx(1)) nlag=24;
run;